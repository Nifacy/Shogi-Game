# Цель проекта

Цель проекта - разработка web приложения для игры в пошаговую игру "Сёги" с поддержкой мультиплеера.

<!-- # Целевая аудитория

Целевой аудиторией проекта будут люди, только начавшие интересоваться Сеги и желающие играть с телефона или на компьютере.
Для них это будет гораздо удобнее, чем ходить по meetup-ам и искать себе соперников в реальной жизни.

Проект актуален тем, что в интернете довольно мало сайтов по этой тематике. В основном, они предназначены для
профессионалов, и новичок просто запутается в переизбытке функционала. Плюсы нашего проекта заключается в
"казуальном" функционале сервиса (т. е. максимально ограниченный и понятный обычному пользователю). -->

# Описание системы
<!-- 
Примечание - далее под сессией подразумевается игровая сессия между двумя пользователями. -->

## Функциональные блоки

Система имеет следующие функциональные блоки:
* Регистрация / авторизация пользователей
* Информация о пользователе
* Игровая сессия
* Автоматический подбор противника
* Создание приватных приглашений на игру

## Регистрация пользователей

При регистрации пользователя пользователь должен ввести пароль и **уникальный** никнейм. Система должна проверить
никнейм на уникальность и занести данные пользователя в систему. Введенный пароль должен храниться в системе
в зашифрованном виде.

При входе в систему пользователь также вводит пароль и никнейм. Система проверяет существование аккаунта в системе,
сверяет зашифрованную версию введенного пароля с той, которая находится в системе. При успешном входе система
должна вернуть пользователю токен доступа.

## Авторизация пользователей

Перед работой с сервисом пользователь должен сначала пройти аутентификацию. Для аутентификации
пользователь должен передать токен доступа, который ему выдали при входе в систему. Система проверяет валидность
токена, и при успешной проверке обрабатывает запрос пользователя.

## Информация о пользователе

Каждый пользователь имеет следующие данные:
* никнейм
* рейтинг

Система должна иметь функционал для:
* получения информации о любом пользователя через введенный никнейм
* получения информации о своем аккаунте (если он до этого авторизовался)

## Игровая сессия

Два игрока могут играть между собой в рамках игровой сессии. Каждая игровая сессия имеет свой уникальный `id`. Через
него пользователь посылает запросы к конкретной комнате через систему.

Система должна иметь функционал для подключения к сессии по `id`. При подключении к комнате сначала должна пройти
проверка, что пользователь зарегистрирован в этой комнате. Аутентификация пользователя должна происходить через
токен доступа, который передают в качестве параметра запроса.

Если токен доступа неверный или пользователь не имеет доступа к игровой сесссии, то ему должно прийти соответствующее
сообщение. После чего соединение должно закрыться.

Общение с игровой сессией должно быть **двунаправленным**. То есть, после успешного подключения пользователь
может отправлять команды комнате и, с другой стороны, получать от нее сообщения
(например, об изменении игрового состояния).

### Соединение с игровой сессией

У соединения игрока с комнатой есть 2 состояния: подключен, не подключен.

Если игрок не устанавливал или разорвал соединение с комнатой, то считаем его не подключенным.
При таком состоянии у пользователя есть некоторое время, чтобы подключиться заново. Если указанное время
прошло, то считаем, что он проиграл.

Если первый не подключен, и второй разорвал соединение, то начинаем отсчет времени заново. По прошествии времени,
если у обоих игроков состояние соединения "не подключен", то просто удаляем игровую сессию.

## Создание / завершение сессии

Пользователь может создавать игровые сессии только 2-мя способами: через подбор противника, через создание
приватной комнаты.

Завершить сессию, как было сказано выше, пользователь может только разорвав соединение.

## Общение клиентов в рамках сессии

Общение клиентов с объектом-сессией должно быть осуществлено через некоторый API. То есть, долже нбыть определенный формат
отправляемых команд и получаемых сообщений. В качестве формата представления сообщений может подойти JSON. Итого, команды,
отправляемые пользователем должны быть построены по следующему шаблону:

```json
{
    "command_id": str, // тип команды
    // поля, специфичные для каждого типа команд...
}
```

Сообщения, отправляемые с сервера клиентам должны быть следующего формата

```json
{
    "event_type": str, // тип события, которое произошло
    // дополнительная информация о событии...
}
```

## Автоматический поиск противника

Пользователь ставит диапазон рейтинга соперника, и система автоматически подбирает его. Поиск происходит до тех пор,
пока противник не найдется. Пользователь может отменить поиск.

Также, пользователь не может отправить более одного запроса на поиск сразу. Чтобы отправить второй необходимо
отменить первый.

## Создание приглашений на игру

Пользователь может создать приватную комнату. При создании приватной комнаты генерируется специальный
ключ доступа, представляющий некоторую строку. По этому ключу может подключиться другой пользователь.
После подключения соперника автоматически должна создаваться игровая сессия для них.

После создания игровой сессии тем, кто находится в приватной комнате, должно прийти уведомление, что игра началась.
